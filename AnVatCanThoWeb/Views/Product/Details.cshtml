@using AnVatCanThoWeb.ViewModels

@model DetailProductVM

@{
    ProductVM productVM = Model.ProductVM;
    List<ProductVM> relatedProductVM = Model.RelatedProduct;
}

<main class="bg-gray">
    <div class="container py-3 ">
        <div class="row product-breadcrumb">
            <div class="col">
                <nav aria-label="breadcrumb align-items-center">
                    <ol class="breadcrumb breadcrumb-text-light breadcrumb-primary text-white mb-0">
                        <li class="breadcrumb-item"><a asp-action="Index" asp-controller="Home">Trang chủ</a></li>
                        <li class="breadcrumb-item"><a asp-action="Index" asp-controller="Product">Sản phẩm</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Chi tiết sản phẩm</li>
                    </ol>
                </nav>
            </div>
        </div>

        <div class="card shadow border-white p-4 mt-4">
            <div class="row">
                <div class="col-12 col-lg-6">
                    <div id="carouselProduct" class="carousel slide carousel-fade rounded overflow-hidden" data-bs-ride="carousel">
                        <div class="carousel-indicators">
                            @* Lặp qua các hình ảnh của sản phẩm để hiển thị*@
                            <button type="button" data-bs-target="#carouselProduct" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                            <button type="button" data-bs-target="#carouselProduct" data-bs-slide-to="1" aria-label="Slide 2"></button>
                            <button type="button" data-bs-target="#carouselProduct" data-bs-slide-to="2" aria-label="Slide 3"></button>
                        </div>
                        <div class="carousel-inner">
                            @* Lặp qua các hình ảnh của sản phẩm hiển thị*@
                            <div class="carousel-item active">
                                <img src="https://picsum.photos/200/300" class="d-block w-100 product-img-carousel" alt="Hình ảnh sản phẩm">
                            </div>
                            <div class="carousel-item">
                                <img src="https://picsum.photos/200/300" class="d-block w-100 product-img-carousel" alt="Hình ảnh sản phẩm">
                            </div>
                            <div class="carousel-item">
                                <img src="https://picsum.photos/200/300" class="d-block w-100 product-img-carousel" alt="Hình ảnh sản phẩm">
                            </div>
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#carouselProduct" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#carouselProduct" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>
                <div class="col-12 mt-3 col-lg-6 mt-lg-0">
                    <h3 class="fw-bold">@productVM.Product.Name</h3>
                    <div class="d-flex align-items-center mt-3">
                        <div class="d-flex align-items-center">
                            @{
                                int numberOfStar = (int)productVM.AvgRating;
                            }
                            @for (int i = 1; i <= 5; i++)
                            {
                                if (i <= numberOfStar)
                                {
                                    <span class="star fas fa-star text-warning me-1"></span>
                                }
                                else
                                {
                                    <span class="star fas fa-star text-gray me-1"></span>
                                }
                            }

                            <span class="ms-2 text-decoration-underline text-dark-gray">@productVM.AvgRating</span>
                        </div>

                        <span class="vertical-divider"></span>

                        <p class="my-0">@productVM.Product.Ratings.Count đánh giá</p>
                    </div>



                    <p class="text-muted mt-3 product-truncate-text--4">
                        @productVM.Product.Description 
                        It is a long established fact that a reader will be distracted by the readable 
                        content of a page when looking at its layout. The point of using Lorem Ipsum is 
                        that it has a more-or-less normal distribution of letters, as opposed to using 
                        'Content here, content here', making it look like readable English. Many desktop 
                        publishing packages and web page editors now use Lorem Ipsum as their default 
                        model text, and a search for 'lorem ipsum' will uncover many web sites still in 
                        their infancy. Various versions have evolved over the years, sometimes by 
                        accident, sometimes on purpose (injected humour and the like).
                    </p>

                    <div class="mt-3">
                        <span class="fw-bold text-muted">Giá bán: </span>
                        <span class="product-text-primary h3 ms-2 fw-bold">@productVM.Product.UnitPrice.ToString("#,###") đ</span>
                    </div>

                    <div class="mt-3">
                        <span class="fw-bold text-muted">Địa chỉ: </span>
                        <ul class="fs-5">
                            @foreach (var address in productVM.Product.SnackBar.Addresses)
                            {
                                <li>@address.NoAndStreet, @address.WardName, @address.DistrictName</li>

                            }
                        </ul>
                    </div>

                    <div class="mt-3 d-flex align-items-center">
                        <span class="fw-bold text-muted">Số lượng: </span>
                        <input class="form-control w-25 ms-2" type="number" name="quantity" min="1" max="50" />
                    </div>

                    <div class="mt-5 d-flex align-items-center gap-4">
                        <button type="button" class="btn add-favor-btn product-bg-primary--light d-flex align-items-center py-2">
                            <i class="far fa-heart fs-5"></i>
                            <span class="ms-2">Thêm vào danh sách yêu thích</span>
                        </button>

                        <button type="button" class="btn btn-success py-2">
                            <span>Đặt ngay</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>


        <div class="card shadow border-white p-4 mt-4">
            <h4>Có thể bạn quan tâm</h4>
            <div class="row mt-4">
                @* Sản phẩm liên quan *@
                @foreach (var realatedProduct in relatedProductVM)
                {
                    <div class="col-6 col-md-4 col-lg-3 mb-4">
                        <div class="card shadow rounded-3">
                            <img src="https://picsum.photos/200/300" class="card-img-top product-image-height rounded-top" alt="Hình ảnh sản phẩm">

                            <div class="card-body border-top border-gray-300">
                                <h3 class="fs-5 fw-bold">@realatedProduct.Product.Name</h3>
                                <a asp-action="Details" asp-controller="Shop" asp-route-id="@realatedProduct.Product.SnackBarId" class="h6 fw-bold">@realatedProduct.Product.SnackBar.DisplayName</a>
                                <h5 class="h6 fw-semibold text-gray mt-2 product-truncate-text">@realatedProduct.Product.Description</h5>
                                <div>
                                    <span class="h6 mb-0 text-decoration-line-through me-2 text-gray">
                                        @realatedProduct.Product.UnitPrice.ToString("#,###") đ
                                    </span>
                                    @* Cần xử lý giá giảm ở đây, hiện tại chỉ hiển thị tạm *@
                                    <span class="h5 mb-0 text-danger">@realatedProduct.Product.UnitPrice.ToString("#,###") đ</span>
                                </div>
                                <div class="d-flex mt-3">
                                    @{
                                        numberOfStar = (int)realatedProduct.AvgRating;
                                    }
                                    @for (int i = 1; i <= 5; i++)
                                    {
                                        if (i <= numberOfStar)
                                        {
                                            <span class="star fas fa-star text-warning me-1"></span>
                                        }
                                        else
                                        {
                                            <span class="star fas fa-star text-gray me-1"></span>
                                        }
                                    }

                                    <span class="badge ms-2 text-dark-gray">@realatedProduct.AvgRating</span>
                                </div>

                            </div>
                            <div class="card-footer bg-gray-200 border-top border-gray-300 p-4">
                                <div class="d-flex align-items-center">
                                    <div class="me-auto">
                                        <button onClick="AddToHeartList('heart_icon_@realatedProduct.Product.Id')" class="btn product-heart-btn px-1 fs-4" id="heart_icon_@realatedProduct.Product.Id" type="button" aria-label="Thêm vào danh sách yêu thích" title="Thêm vào danh sách yêu thích">
                                            <i aria-hidden="true" class="far fa-heart"></i>
                                        </button>
                                    </div>
                                    <a class="btn btn-success rounded-3" asp-action="Details" asp-controller="Product" asp-route-id="@realatedProduct.Product.Id">Chi tiết</a>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>

        <h4>Đánh giá</h4>
        <div class="row mt-4">
            <div class="col-12 col-lg-3">
                @* Rating *@
            </div>
            <div class="col-12 col-lg-9">
                @* Bình luận *@
            </div>
        </div>
    </div>
</main>

@section Styles {
    <link rel="stylesheet" href="~/css/product.css" asp-append-version="true"></link>
}

@section Scripts {
    <script src="~/js/product.js"></script>
}